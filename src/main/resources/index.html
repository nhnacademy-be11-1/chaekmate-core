<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chaekmate 쇼핑몰 데모</title>
    <style>
        :root{--primary:#2b6cb0;--accent:#ffd166;--muted:#6b7280}
        body{font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial; margin:0; color:#111}
        .wrap{max-width:1200px;margin:24px auto;padding:0 16px}
        header{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
        .logo{display:flex;align-items:center;gap:12px}
        .logo .brand{font-weight:700;font-size:20px;color:var(--primary)}
        .search{flex:1;margin:0 24px}
        .search input{width:100%;padding:10px;border-radius:8px;border:1px solid #e5e7eb}
        main{display:grid;grid-template-columns:1fr 320px;gap:24px;margin-top:16px}
        /* product grid */
        .products{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}
        .card{border:1px solid #e6e7eb;border-radius:10px;padding:12px;display:flex;flex-direction:column;gap:8px;background:#fff}
        .card img{width:100%;height:160px;object-fit:cover;border-radius:6px}
        .card .title{font-weight:600}
        .card .meta{color:var(--muted);font-size:13px}
        .card .price{font-weight:700;color:#111}
        .card button{margin-top:auto;padding:10px;border:0;border-radius:8px;background:var(--primary);color:#fff;cursor:pointer}
        /* cart */
        .cart{border:1px solid #e6e7eb;border-radius:10px;padding:12px;background:#fafafa}
        .cart h3{margin:0 0 8px 0}
        .cart-list{display:flex;flex-direction:column;gap:8px;max-height:420px;overflow:auto;padding-right:4px}
        .cart-item{display:flex;gap:8px;align-items:center}
        .cart-item img{width:54px;height:54px;object-fit:cover;border-radius:6px}
        .cart-item .info{flex:1}
        .qty{display:flex;align-items:center;gap:6px}
        .qty button{width:28px;height:28px;border-radius:6px;border:1px solid #ddd;background:#fff}
        .checkout{display:flex;align-items:center;justify-content:space-between;margin-top:12px}
        .checkout button{padding:10px 14px;border:0;border-radius:8px;background:var(--primary);color:#fff}
        .empty{color:var(--muted);text-align:center;padding:24px 0}
        footer{margin:36px 0;text-align:center;color:var(--muted);font-size:13px}
        @media(max-width:900px){main{grid-template-columns:1fr;}
            .search{margin:12px 0}
        }
    </style>
</head>
<body>
<div class="wrap">
    <header>
        <div class="logo">
            <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect width="24" height="24" rx="6" fill="#2B6CB0"></rect>
                <path d="M7 8h10v2H7zM7 12h6v2H7z" fill="#fff"/>
            </svg>
            <div>
                <div class="brand">Chaekmate</div>
                <div style="font-size:12px;color:var(--muted)">책과 포인트가 함께하는 샵 데모</div>
            </div>
        </div>
        <div class="search"><input id="searchInput" placeholder="제품 검색 (예: 소설, 요리책 등)"></div>
        <div><button id="viewCartBtn" onclick="toggleCart()">장바구니 (<span id="cartCount">0</span>)</button></div>
    </header>

    <main>
        <section>
            <div style="display:flex;align-items:center;justify-content:space-between">
                <h2 style="margin:0">추천 도서</h2>
                <div style="color:var(--muted)">총 <span id="productCount">0</span>개</div>
            </div>

            <div class="products" id="products"></div>
        </section>

        <aside>
            <div class="cart" id="cartPanel">
                <h3>장바구니</h3>
                <div class="cart-list" id="cartList"></div>
                <div class="checkout">
                    <div>
                        합계: <strong id="cartTotal">0</strong>원
                    </div>
                    <div>
                        <button id="clearBtn">비우기</button>
                        <button id="checkoutBtn">결제하기</button>
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <footer>
        © Chaekmate Demo
    </footer>
</div>

<script>
    // 샘플 제품 데이터 (실제 프로젝트에서는 API로 대체)
    const sampleProducts = [
        {id: 'p1', title: '자바 핵심 가이드', description: '자바 초중급자를 위한 핵심 정리', price: 25000, img: 'https://picsum.photos/seed/book1/400/300'},
        {id: 'p2', title: '실용 리액트', description: '현업에서 바로 쓰는 리액트 패턴', price: 30000, img: 'https://picsum.photos/seed/book2/400/300'},
        {id: 'p3', title: '요리의 기술', description: '집밥을 변화시키는 레시피', price: 18000, img: 'https://picsum.photos/seed/book3/400/300'},
        {id: 'p4', title: '데이터 과학 입문', description: '파이썬과 통계로 배우는 데이터 과학', price: 32000, img: 'https://picsum.photos/seed/book4/400/300'},
        {id: 'p5', title: '그림으로 배우는 디자인', description: '디자인 기초를 시각적으로 이해', price: 22000, img: 'https://picsum.photos/seed/book5/400/300'}
    ];

    // 로컬스토리지 키
    const CART_KEY = 'chaekmate_cart_v1';

    function formatPrice(v){ return v.toLocaleString('ko-KR'); }

    // Cart state
    let cart = JSON.parse(localStorage.getItem(CART_KEY) || '{}');

    function saveCart(){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); renderCart(); }

    function renderProducts(list){
        const container = document.getElementById('products');
        container.innerHTML = '';
        list.forEach(p => {
            const el = document.createElement('div'); el.className='card';
            el.innerHTML = `
                <img src="${p.img}" alt="${p.title}">
                <div class="title">${p.title}</div>
                <div class="meta">${p.description}</div>
                <div class="price">${formatPrice(p.price)}원</div>
                <button data-id="${p.id}">장바구니에 담기</button>
            `;
            container.appendChild(el);
        });
        document.getElementById('productCount').textContent = list.length;
    }

    function addToCart(productId){
        const prod = sampleProducts.find(p=>p.id===productId);
        if(!prod) return;
        if(!cart[productId]) cart[productId] = {...prod, qty:0};
        cart[productId].qty++;
        saveCart();
        flash(`${prod.title}이(가) 장바구니에 추가되었습니다.`);
    }

    function removeFromCart(productId){
        delete cart[productId]; saveCart();
    }

    function changeQty(productId, delta){
        if(!cart[productId]) return;
        cart[productId].qty += delta;
        if(cart[productId].qty <= 0) delete cart[productId];
        saveCart();
    }

    function renderCart(){
        const listEl = document.getElementById('cartList');
        listEl.innerHTML = '';
        const keys = Object.keys(cart);
        if(keys.length === 0){ listEl.innerHTML = '<div class="empty">장바구니가 비었습니다.</div>'; document.getElementById('cartTotal').textContent = '0'; document.getElementById('cartCount').textContent = '0'; return; }
        let total = 0; let count = 0;
        keys.forEach(k=>{
            const item = cart[k];
            total += item.price * item.qty; count += item.qty;
            const el = document.createElement('div'); el.className='cart-item';
            el.innerHTML = `
                <img src="${item.img}" alt="${item.title}">
                <div class="info">
                    <div style="font-weight:600">${item.title}</div>
                    <div style="font-size:13px;color:var(--muted)">${formatPrice(item.price)}원</div>
                </div>
                <div class="qty">
                    <button data-action="dec" data-id="${k}">-</button>
                    <div>${item.qty}</div>
                    <button data-action="inc" data-id="${k}">+</button>
                    <button data-action="del" style="margin-left:8px;" data-id="${k}">삭제</button>
                </div>
            `;
            listEl.appendChild(el);
        });
        document.getElementById('cartTotal').textContent = formatPrice(total);
        document.getElementById('cartCount').textContent = count;
    }

    function toggleCart(){ const el = document.getElementById('cartPanel'); el.style.display = (el.style.display==='none' ? 'block' : 'block'); window.scrollTo({top:0,behavior:'smooth'}); }

    function flash(msg){
        const t = document.createElement('div');
        t.style.position='fixed';t.style.right='16px';t.style.bottom='16px';t.style.background='#111';t.style.color='#fff';t.style.padding='10px 14px';t.style.borderRadius='8px';t.style.opacity='0.95';
        t.textContent = msg; document.body.appendChild(t);
        setTimeout(()=>t.remove(),2000);
    }

    // 이벤트 delegation
    document.addEventListener('click', (e)=>{
        const btn = e.target.closest('button');
        if(!btn) return;
        const id = btn.dataset.id;
        if(btn.dataset.action === 'inc') changeQty(id, 1);
        else if(btn.dataset.action === 'dec') changeQty(id, -1);
        else if(btn.dataset.action === 'del') removeFromCart(id);
        else if(id) addToCart(id);
    });

    document.getElementById('clearBtn').addEventListener('click', ()=>{ cart={}; saveCart(); });
    document.getElementById('checkoutBtn').addEventListener('click', ()=>{
        if(Object.keys(cart).length===0){ alert('장바구니가 비어있습니다.'); return; }
        alert('간단 데모: 결제 처리를 시뮬레이션합니다. 총 ' + document.getElementById('cartTotal').textContent + '원');
        cart={}; saveCart();
    });

    document.getElementById('searchInput').addEventListener('input',(e)=>{
        const q = e.target.value.trim().toLowerCase();
        const filtered = sampleProducts.filter(p=> p.title.toLowerCase().includes(q) || p.description.toLowerCase().includes(q));
        renderProducts(filtered);
    });

    // 초기 렌더링
    renderProducts(sampleProducts);
    renderCart();

</script>
</body>
</html>